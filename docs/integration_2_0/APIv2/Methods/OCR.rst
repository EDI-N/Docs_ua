######################################################################
OCR API інтеграція
######################################################################

Дана інструкція описує послідовність викликів методів API для розпізнавання тексту та інтелектуального вилучення даних з документів.

.. contents:: Послідовність дій:
    :depth: 1
    :local:

----------------

1. Авторизація
========================================================

Для виклику методів API користувач повинен пройти `авторизацію <https://wiki.edin.ua/uk/latest/integration_2_0/APIv2/Methods/Authorization.html>`__ .

2. Відправка документа на розпізнання
========================================================

**URL**

.. table::

   +------------------+-----------------------------------------------------+
   | **Метод запиту** | POST                                                |
   +------------------+-----------------------------------------------------+
   | **URL запиту**   | https://edo-v2.edin.ua/api/ocr/experimental/v1/send | 
   +------------------+-----------------------------------------------------+

**Headers**

.. table::

   +-------------------+-----------------------------------------------------+
   | **Authorization** | {Session Key}                                       |
   +-------------------+-----------------------------------------------------+
   | **Content-Type**  | application/pdf | image/png | image/jpeg            |
   +-------------------+-----------------------------------------------------+


**REQUEST**

.. table::

   +----------------+--------------------------------------------------------+
   | **JSON Body**  | Байтовий вміст файлу (PDF/зображення)                  |
   +----------------+--------------------------------------------------------+

**RESPONSE**

У відповідь надходить унікальний ідентифікатор (**UUID**) завдання на конвертацію.


1. Отримання статусу обробки
========================================================

Метод рекомендовано викликати не частіше ніж 1 раз на 15 секунд.

**URL**

.. table::

   +------------------+---------------------------------------------------------------------------------+
   | **Метод запиту** | GET                                                                             |
   +------------------+---------------------------------------------------------------------------------+
   | **URL запиту**   | https://edo-v2.edin.ua/api/ocr/experimental/v1/result?task_uuid={UUID завдання} | 
   +------------------+---------------------------------------------------------------------------------+



**Headers**

.. table::

   +-------------------+------------------------------------------------------------+
   | **Authorization** | {Session Key}                                              |
   +-------------------+------------------------------------------------------------+

**RESPONSE**

У відповідь надходить статус завдання на конвертацію.

Можливі статуси обробки завдання: 

    * **"CREATED"** - створено та очікує в черзі;
    * **"PROCESSING"** - в процесі виконання;
    * **"DONE"** — виконано;
    * **"ERROR"** — помилка.


4. Отримання результату конвертації
========================================================

Метод викликається після отримання статусу **"DONE"**.

**URL**

.. table::

   +------------------+---------------------------------------------------------------------------------+
   | **Метод запиту** | GET                                                                             |
   +------------------+---------------------------------------------------------------------------------+
   | **URL запиту**   | https://edo-v2.edin.ua/api/ocr/experimental/v1/result?task_uuid={UUID завдання} | 
   +------------------+---------------------------------------------------------------------------------+

**Headers**

.. table::

   +-------------------+------------------------------------------------------------+
   | **Authorization** | {Session Key}                                              |
   +-------------------+------------------------------------------------------------+


**RESPONSE**

У відповідь надходить: 

    * результат конвертації у вигляді JSON-документа;
    * у заголовках (headers) відповіді присутній параметр X-Doc-Type, який містить визначений тип документа.