#############################################################
**Масова реєстрація аккаунтів**
#############################################################

Для роботи з цим методом користувач повинен бути `авторизованим <https://wiki.edi-n.com/uk/latest/API_DOCflow/Methods/Authorization.html>`__ .

.. important:: 
    У кожного аккаунта повинна бути хоча б одна компанія і один користувач. На підставі отриманих даних в системі будуть створені аккаунти, компанії і користувачі. Всі користувачі, будуть відзначені, як власники аккаунта, компанії не підтверджені ЕЦП.

+----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
|                        **Метод запиту**                        |                                               **HTTP POST**                                                |
+================================================================+============================================================================================================+
| **Content-Type**                                               | application/json (тіло запиту/відповіді в json форматі в тілі HTTP запиту)                                 |
+----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
| **URL запиту**                                                 | **https://doc.edi-n.com/bdoc_admin/register_account_list**                                                 |
+----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
| **Параметри, що передаються в URL (разом з адресою методу)**   | В рядку заголовка (Header) "Set-Cookie" обов'язково передається **SID** - токен, отриманий при авторизації |
+----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
| **Обов'язкові параметри, що передаються в тілі запиту (json)** | accName, **companies**, **users**, edrpou, inn, name, ownType, email, fio                                  |
+----------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+

**JSON-параметри в тілі HTTP запиту/відповіді**
*******************************************************************

``REQUEST``

Таблиця 1 - Опис json-параметрів **запиту** метода API

+-----------+--------------------+----------------+-------------------------------------+
| Параметр  | Mandatory/Optional |     Формат     |                Опис                 |
+===========+====================+================+=====================================+
| accName   | M                  | long           | назва компанії                      |
+-----------+--------------------+----------------+-------------------------------------+
| companies | M                  | List<Company_> | масив об'єктів з даними компанії    |
+-----------+--------------------+----------------+-------------------------------------+
| users     | M                  | List<User_>    | масив об'єктів з даними користувача |
+-----------+--------------------+----------------+-------------------------------------+

Таблиця 2 - Опис параметрів об'єкта **Company**

.. csv-table:: 
  :file: for_csv/Company.csv
  :widths:  1, 12, 41
  :header-rows: 1
  :stub-columns: 0

Таблиця 2 - Опис параметрів об'єкта **User**

.. csv-table:: 
  :file: for_csv/User.csv
  :widths:  1, 12, 41
  :header-rows: 1
  :stub-columns: 0

``RESPONSE``

Таблиця 3 - Опис json-параметрів **відповіді** метода API

+--------------+----------------+--------------------------------------------------+
|   Параметр   |     Формат     |                       Опис                       |
+==============+================+==================================================+
| accName      | long           | назва компанії                                   |
+--------------+----------------+--------------------------------------------------+
| companies    | List<Company_> | масив об'єктів з даними компанії                 |
+--------------+----------------+--------------------------------------------------+
| users        | List<User_>    | масив об'єктів з даними користувача              |
+--------------+----------------+--------------------------------------------------+
| handleResult |                | повідомлення щодо дії запиту;                    |
|              |                |                                                  |
|              |                | ``created`` - "1" створено /  "0" - не створено  |
|              |                |                                                  |
|              |                | ``error`` - опис помилки, якщо **created** = "0" |
|              |                |                                                  |
|              |                | додається в кожний json елемент компанії         |
+--------------+----------------+--------------------------------------------------+

--------------

**Приклади**
*****************

Приклад тіла **запиту** (json):

.. code:: ruby

  {
  [
    {
      "accName": "Летюд ТОВ",
      "companies": [
        {
          "edrpou": "1212",
          "inn": "1243546556",
          "name": "Летюд",
          "ownType": "ТОВ"
        },
        {
          "edrpou": "435465",
          "inn": "124354653454556",
          "name": "Летюдewewe",
          "ownType": "ТОВ"
        }
      ],
      "users": [
        {
          "email": "test@test",
          "fio": "Иванов Иван"
        },
        {
          "email": "test2@test2",
          "fio": "Иванов2 Иван2"
        }
      ]
    },
    {
      "accName": "ФОП Сокол О.В.",
      "companies": [
        {
          "edrpou": "343434",
          "inn": "3435467",
          "name": "Сокол О.В.",
          "ownType": "ФОП"
        }
      ],
      "users": [
        {
          "email": "sokolov@test",
          "fio": "Иванов Иван"
        }
      ]
    }
  ]
  }

--------------

Приклад тіла **відповіді** (json): 

.. code:: ruby

  {
  [
      {
          "accName": "Летюд ТОВ",
          "companies": [
              {
                  "edrpou": "1212",
                  "inn": "1243546556",
                  "name": "Летюд",
                  "ownType": "ТОВ"
              },
              {
                  "edrpou": "435465",
                  "inn": "124354653454556",
                  "name": "Летюдewewe",
                  "ownType": "ТОВ"
              }
          ],
          "handleResult": {
              "created": 1
          },
          "users": [
              {
                  "email": "test@test",
                  "fio": "Иванов Иван",
                  "handleResult": {
                      "created": 1
                  }
              },
              {
                  "email": "test2@test2",
                  "fio": "Иванов2 Иван2",
                  "handleResult": {
                      "created": 1
                  }
              }
          ]
      },
      {
          "accName": "ФОП Сокол О.В.",
          "companies": [
              {
                  "edrpou": "343434",
                  "handleResult": {
                      "created": 0,
                      "error": "compnay allready exisrts"
                  },
                  "inn": "3435467",
                  "name": "Сокол О.В.",
                  "ownType": "ФОП"
              }
          ],
          "handleResult": {
              "created": 1
          },
          "users": [
              {
                  "email": "sokolov@test",
                  "fio": "Иванов Иван",
                  "handleResult": {
                      "created": 1
                  }
              }
          ]
      }
  ]
  }


