########################################################################################################################
Підписання в сервісі WhiteDoc
########################################################################################################################

.. початок блоку для WD_Signing

.. _підписання:

Реалізовані два способи підписання документів:

1) Підписання кожного документа вручну в формі конверта. В документі в блоці з обов'язковими підписами потрібно натиснути на поле, де Ви вказані підписантом:

.. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_002.png
   :align: center

2) масове підписання документів у всіх обраних конвертах через журнал `Мейлбокса <https://wiki.edin.ua/uk/latest/WhiteDoc/WD_Instructions/Work_with_WD.html#mailbox>`__:

.. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_001.png
   :align: center

------------------------------------

.. початок блоку для WD_candidate_questionnaire

При підписанні відкривається вікно, що складається з 3 кроків:

.. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_009.png
   :align: center

Для початку потрібно обрати зручний для Вас метод підписання (за замовчуванням обрано **Електронно цифровий ключ**):

* **Електронно цифровий ключ**
* **Кваліфікований електронний підпис**
* **SmartId** ("ПриватБанк")
* **Дія.Підпис**
* **Інші пристрої електронного підпису**

.. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_010.png
   :align: center

.. tabs::

   .. tab:: "ЕЦП"

      Для підписання **Електронно цифровим ключем** потрібно обрати файл з локального сховища, ввести пароль і **"Відкрити ключ"**:

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_011.png
         :align: center

      .. початок блоку для WD_repeat

      В якості підтвердження корекності введеної пари ключ/пароль відображаються дані майбутнього підписанта. Потрібно натиснути кнопку **"Далі"**:

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_012.png
         :align: center

      .. hint::
         Якщо ключ було обрано помилково, то його можливо очистити чи вибрати замість нього інший (кнопки **"Обрати новий ключ"** та **"Очистити ключ"**). Додатково можливо разом з підписом накласти печатку за допомогою кнопки **"Додати печатку"**.

      На третьому кроці відображаються всі файли, що будуть створені/змінені в результаті підписання (їх можливо завантажити і перевірити) після натискання **"Далі"**: 

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_013.png
         :align: center

      .. кінець блоку для WD_repeat

   .. tab:: "КЕП"

      Для використання **Кваліфікованого електронного підпису** необхідно вручну встановити спеціальне програмне забезпечення на свій ПК (клієнти, що вже інсталювали це ПЗ можуть пропустити наступний крок).

      .. admonition:: Встановлення спеціалізованого ПЗ для використання КЕП
         
         Перед встановленням програмного забезпечення рекомендовано оновити браузер і завантажити останню версію Вашої ОС.

         1. Завантажте та встановіть криптобібліотеку (`MacOS <https://iit.com.ua/download/productfiles/EUSignWebInstall.pkg>`__, `Windows <https://iit.com.ua/download/productfiles/EUSignWebInstall.exe>`__), щоб отримати доступ до своїх кваліфікованих ключів.
         2. Додайте `розширення для браузера <https://chrome.google.com/webstore/detail/%D1%96%D1%96%D1%82-%D0%BA%D0%BE%D1%80%D0%B8%D1%81%D1%82%D1%83%D0%B2%D0%B0%D1%87-%D1%86%D1%81%D0%BA-1-%D0%B1%D1%96%D0%B1%D0%BB/jffafkigfgmjafhpkoibhfefeaebmccg?utm_source=chrome-app-launcher-info-dialog>`__, щоб отримати доступ до криптобібліотеки з браузера.
         3. Перезавантажте ПК.

      Дочекайтеся завершення процесу пошуку пристроїв. Виберіть апаратний ключ, введіть пароль ключа та натисніть кнопку **"Відкрити ключ"** (якщо ви введете дійсний пароль і ключ дійсний, Ви побачите деталі підпису та наступну форму модального вікна, якщо ні, ви побачите помилку повідомлення):

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_014.png
         :align: center

      .. include:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing.rst
         :start-after: .. початок блоку для WD_repeat
         :end-before: .. кінець блоку для WD_repeat

   .. tab:: "SmartId"

      Після того, як Ви обрали підписання за допомогою **SmartId** ("ПриватБанк"), генерується qr-код для переходу в мобільний додаток (або кнопка **"Зчитати ключ"** якщо всі дії відбуваються з мобільного):

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_015.png
         :align: center

      Для того аби підписати документ потрібно прочитати qr-код в мобільному додатку **"Privat24"**, використовуючи "Сканер" (потребує використання камери) та пройти авторизацію **"SmartID"**:

      .. image:: /_constant/cloud_signing/cloud_signing_003.png
         :align: center

      Сервіс автоматично підтягне Вашу КЕП. В якості підтвердження корекності введеної пари ключ/пароль відображаються дані майбутнього підписанта. Потрібно натиснути кнопку **"Далі"**:

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_012.png
         :align: center

      .. hint::
         Якщо ключ було обрано помилково, то його можливо очистити чи вибрати замість нього інший (кнопки **"Обрати новий ключ"** та **"Очистити ключ"**). Додатково можливо разом з підписом накласти печатку за допомогою кнопки **"Додати печатку"**.

      На третьому кроці відображаються всі файли, що будуть створені/змінені в результаті підписання (їх можливо завантажити і перевірити) після натискання **"Далі"**: 

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_013.png
         :align: center

      Продовжуючи підписання, відобразиться ще один QR-код, який потрібно знову відсканувати в мобільному додатку **"Privat24"** (потрібно повторно виконати дії в додатку описані вище) і всі документи будуть підписані.

   .. tab:: "Дія.Підпис"

      Після того, як Ви обрали підписання за допомогою **Дія.Підпис** при перегляді через ПК відображається qr-код для переходу в мобільний додаток "Дія", а при перегляді через смартфон відображається посилання для переходу в додаток.

      Для того аби прочитати qr-код в мобільному додатку "Дія" потрібно за потреби дозволити додатку використовувати камеру:

      .. image:: /_constant/diya_signing/diya_signing_002.png
         :width: 500 px

      .. image:: /_constant/diya_signing/diya_signing_003.png
         :width: 520 px

      Після формування запиту в додатку "Дія" можливо **"Підписати"** документ (потребує підтвердження особи за допомогою камери та введення коду для Дія.Підпис):

      .. image:: /_constant/diya_signing/diya_signing_004.png
         :width: 350 px

      .. image:: /_constant/diya_signing/diya_signing_005.png
         :width: 350 px

      .. image:: /_constant/diya_signing/diya_signing_006.png
         :width: 350 px

      .. include:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing.rst
         :start-after: .. початок блоку для WD_repeat
         :end-before: .. кінець блоку для WD_repeat

   .. tab:: "Інше"

      В якості **Іншого пристрою електронного підпису** розглянемо bluetooth-токен, вироблений IIT. Для роботи з ним необхідно вручну встановити спеціальне програмне забезпечення на свій мобільний пристрій (клієнти, що вже інсталювали це ПЗ можуть пропустити наступний крок).

      .. admonition:: Встановлення спеціалізованого ПЗ
         
         Перед встановленням програмного забезпечення рекомендовано оновити браузер і завантажити останню версію Вашої ОС.

         1. Завантажте та встановіть клієнт підпису відповідно до своєї ОС (`клієнт підпису для Apple iOS <https://apps.apple.com/ua/app/iit-sign-client/id1467005893>`__ / `клієнт підпису для Google Android <https://play.google.com/store/apps/details?id=ua.com.iit.signclient>`__), щоб отримати доступ до Ваших кваліфікованих ключів.
         2. Відкрийте програму "ІІТ Клієнт підпису" і зареєструйте нового користувача за допомогою токена bluetooth:
            
            * Натисніть значок "+" у додатку;
            * Виберіть тип ключа (якщо Ви використовуєте Bluetooth-токен Bluetooth-пристрою Алмаз-1К виберіть опцію "Ключовий носій");
            * Натисніть кнопку "Прочитати" і знову натисніть "Ключовий носій";
            * Увімкніть пристрій bluetooth і дочекайтеся, поки він відобразиться в програмі;
            * Натисніть на нього та введіть пароль до вибраного ключа;
            * Дочекайтеся завершення реєстрації, після чого Ви зможете підключитися до свого ключа, де зможете отримати ідентифікатор ключа.
         
      Виберіть "ІІТ - хмарний підпис", ідентифікатор ключа та натисніть кнопку **"Відкрити ключ"**. З’явиться модальне вікно з підтвердженням, і Ви повинні підтвердити свою дію в програмі "ІІТ Клієнт підпису":

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_018.png
         :align: center

      Сервіс автоматично підтягне Вашу КЕП. При коректному введенні відображаються дані майбутнього підписанта. Потрібно натиснути кнопку **"Далі"**:

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_012.png
         :align: center

      .. hint::
         Якщо ключ було обрано помилково, то його можливо очистити чи вибрати замість нього інший (кнопки **"Обрати новий ключ"** та **"Очистити ключ"**). Додатково можливо разом з підписом накласти печатку за допомогою кнопки **"Додати печатку"**.

      На третьому кроці відображаються всі файли, що будуть створені/змінені в результаті підписання (їх можливо завантажити і перевірити) після натискання **"Далі"**: 

      .. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_013.png
         :align: center

      Продовжуючи підписання, потрібно знову підтвердити свою дію в програмі "ІІТ Клієнт підпису" і всі документи будуть підписані.

В разі виявлених помилок / невідповідностей чи інших причин на цьому етапі можливо **"Вибрати інший підпис"**.

.. note::
   Під час підписання структурованого документа окрім його xml версії генерується друкована версія цього документа в pdf-форматі.

.. attention::
   При підписанні документа через форму конверта для закріплення підпису на документах конверту його обов'язково потрібно **"Відправити"**!  

.. image:: /WhiteDoc/WD_Instructions/WD_signing/WD_signing_008.png
   :align: center

.. кінець блоку для WD_candidate_questionnaire

.. кінець блоку для WD_Signing

