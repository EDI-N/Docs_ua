#############################################################################################################
**Створення картки сертифіката**
#############################################################################################################

Для роботи з цим методом користувач повинен бути `авторизованим <https://wiki.edin.ua/uk/latest/Certificate/EDIN/API/Methods/Authorization.html>`__ .

+--------------------------------------------------------------+--------------------------------------------------------------+
|                       **Метод запиту**                       |                        **HTTP POST**                         |
+==============================================================+==============================================================+
| **Content-Type**                                             | application/json (тіло HTTP запиту/відповіді в json форматі) |
+--------------------------------------------------------------+--------------------------------------------------------------+
| **URL запиту**                                               | **https://edo.edin.ua/Api/V1/Certificate/Create**            |
+--------------------------------------------------------------+--------------------------------------------------------------+
| **Параметри, що передаються в URL (разом з адресою методу)** | -//-                                                         |
+--------------------------------------------------------------+--------------------------------------------------------------+

**JSON-параметри в тілі HTTP запиту/відповіді**
*******************************************************************

``REQUEST``

Таблиця 1 - Опис json-параметрів **запиту**

+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
|     Параметр     | Mandatory/Optional |       Формат        |                                                         Опис                                                          |
+==================+====================+=====================+=======================================================================================================================+
| varToken​        | M                  | String              | токен, отриманий при `авторизації <https://wiki.edin.ua/uk/latest/Certificate/EDIN/API/Methods/Authorization.html>`__ |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_number      | M                  | String(100)         | номер сертифіката                                                                                                     |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_date        | M                  | String "DD.MM.YYYY" | дата видачі сертифіката                                                                                               |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_sub_type    | M                  | String              | вид сертифіката (код із довідника)                                                                                    |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_type        | M                  | String              | тип сертифіката (код із довідника)                                                                                    |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_start_date  | M                  | String "DD.MM.YYYY" | дата початку дії сертифіката                                                                                          |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_end_date    | M...O              | String "DD.MM.YYYY" | дата закінчення дії сертифіката. Поле обов'язкове лише за cert_sub_type=1                                             |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_part_number | M...O              | String(100)         | номер партії. Поле обов'язкове лише за cert_sub_type=2                                                                |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_gln_creator | M                  | String              | GLN власника сертифіката (GLN авторизованого користувача)                                                             |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_lot_number  | O                  | String(50)          | артикул виробника                                                                                                     |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+
| cert_gtd         | O                  | String(100)         | номер ГТД                                                                                                             |
+------------------+--------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------+

.. note:: При створенні картки виконуються наступні перевірки:
    
    * Перевірка на наявність сертифікату з таким номером в сервісі, де власник є GLN, який передає поле **"cert_gln_creator"**, якщо є - повертається помилка (детальніше в **Описі помилок**)
    * GLN в полі **"cert_gln_creator"** повинен бути підв'язаний під авторизованого користувача, якщо не підв'язаний - повертається помилка (детальніше в **Описі помилок**)
    * Дата початку дії (**cert_start_date**) не повинна бути більшою, ніж дата закінчення дії (**cert_end_date**), якщо більше - повертається помилка (детальніше в **Описі помилок**)

``RESPONSE``

Таблиця 2 - Опис json-параметрів **відповіді** метода API

+----------------+--------------------+--------+---------------------------+
|    Параметр    | Mandatory/Optional | Формат |           Опис            |
+================+====================+========+===========================+
| certificate_id |                    | int    | id створеного сертифіката |
+----------------+--------------------+--------+---------------------------+
| ​varMessage​   |                    | String | повідомлення сервера      |
+----------------+--------------------+--------+---------------------------+
| ​intCode​      |                    | int    | код відповіді сервера     |
+----------------+--------------------+--------+---------------------------+

--------------

**Приклади**
*****************

Приклад тіла **запиту** в json форматі:

.. code:: ruby

  {
  "varToken":"nohuola9h24tmj4jln3devi151",
  "cert_number":"Test_api_4",
  "cert_date":"05.06.2018",
  "cert_sub_type":"1",
  "cert_type":"8",
  "cert_start_date":"30.06.2018",
  "cert_end_date":"29.07.2018",
  "cert_part_number":"part_numb_api_1",
  "cert_gln_creator":"9864066822454",
  "cert_lot_number":"lot_numb_api_1",
  "cert_gtd":"gtd_api_1"
  }

--------------

Приклад тіла **відповіді** в json форматі: 

.. code:: ruby

  {
    "certificate_id": "2121",
    "varMessage": "Success!",
    "intCode": 200
  }

.. include:: Create_errors.rst
