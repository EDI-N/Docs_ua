#############################################################
**Отримання архіву**
#############################################################

1.Відправка запиту на формування архіву
----------------------------------------------------

Для роботи з цим методом користувач повинен бути `авторизованим <https://wiki.edin.ua/uk/latest/API_DOCflow/Methods/Authorization.html>`__ .

.. admonition:: Зверніть увагу!

   Повторна відправка даного запиту з таким же packageId - поверне той же PackageArchRequest, новий запит не буде створюватися поки архів не буде скачено!

+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
|                       **Метод запиту**                       |                                              **HTTP GET**                                              |
+==============================================================+========================================================================================================+
| **Content-Type**                                             | application/json (тіло запиту/відповіді в json форматі в тілі HTTP запиту)                             |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
| **URL запиту**                                               |   https://doc.edin.ua/bdoc/store/package-arch/request                                                  |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
| **Параметри, що передаються в URL (разом з адресою методу)** | В рядку заголовка (Header) "Set-Cookie" обов'язково передається SID - токен, отриманий при авторизації |
|                                                              |                                                                                                        |
|                                                              | **Обов'язкові url-параметри:**                                                                         |
|                                                              |                                                                                                        |
|                                                              | **package_id** - ID комплекта документів                                                               |
|                                                              |                                                                                                        |
|                                                              | **Необов'язкові url-параметри:**                                                                       |
|                                                              |                                                                                                        |
|                                                              | **doc_status** - якщо потрібен архів документів певного статусу                                        |
|                                                              |                                                                                                        |
|                                                              | **doc_mark_id** - мітка документу, 1 -  Опрацьовано, все вірно; 2 - Опрацьовано, є помилки;            |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+

**JSON-параметри в тілі HTTP запиту/відповіді**
***********************************************************

``REQUEST``

В цьому методі json-тіло **запиту** відсутнє (інші дані передавати не потрібно).

``RESPONSE``

У **відповідь** передається об'єкт **PackageArchRequest**.

Таблиця 1 - Опис параметрів об'єкта **PackageArchRequest**

.. csv-table:: 
  :file: for_csv/PackageArchRequest.csv
  :widths:  1, 12, 41
  :header-rows: 1
  :stub-columns: 0

**Приклади**
*********************************

**При використанні методу json-тіло запиту відсутнє (дані передавати не потрібно)**

--------------

**У цьому методі у відповідь передається об'єкт PackageArchRequest.**

.. code:: ruby

  {
   "requestUuid": "c7f1354b-93a0-48a7-9b84-5ee50d8f3c6e",
   "userId": 10,
   "packageId": 8129,
   "companyId": 4,
   "docStatuses": [
     1,
     2,
     3,
     4,
     5
   ],
   "isArchReady": 1,
   "zipArchName": "8129_1579690544_2539_3189823647_34554355_2020-02-18-17-28-16.zip"
  }

2.Отримання посилання на скачування архіву
----------------------------------------------------

+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
|                       **Метод запиту**                       |                                              **HTTP GET**                                              |
+==============================================================+========================================================================================================+
| **Content-Type**                                             | application/json (тіло запиту/відповіді в json форматі в тілі HTTP запиту)                             |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
| **URL запиту**                                               |   https://doc.edin.ua/bdoc/store/package-arch/link                                                     |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
| **Параметри, що передаються в URL (разом з адресою методу)** | В рядку заголовка (Header) "Set-Cookie" обов'язково передається SID - токен, отриманий при авторизації |
|                                                              |                                                                                                        |
|                                                              | **Обов'язкові url-параметри:**                                                                         |
|                                                              |                                                                                                        |
|                                                              | **request_uuid** - uuid отриманий у PackageArchRequest                                                 |
|                                                              |                                                                                                        |
+--------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+

**JSON-параметри в тілі HTTP запиту/відповіді**
***********************************************************

``REQUEST``

В цьому методі json-тіло **запиту** відсутнє (інші дані передавати не потрібно).

``RESPONSE``

У **відповідь** передається:

- якщо архів уже сформований - то у відповіді прийде посилання на скачування архіву;
- **814,"trans_in_progress"** - якщо архів ще не сформований і треба почекати 
- **762, "uuid not found"** - якщо за вказаним uuid запис не знайдено 

**Приклади**
*********************************

**При використанні методу json-тіло запиту відсутнє (дані передавати не потрібно)**

--------------

**У цьому методі у відповідь передається посилання на скачування.**